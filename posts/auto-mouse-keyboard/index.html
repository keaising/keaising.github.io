<!DOCTYPE html>
<html lang="zh-Hans" class="han-la">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Auto mouse keyboard - 流水沉微</title>
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/kitto.css">
    <script src="/js/anchor.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="/js/text-autospace.js"></script>
</head>

<body>
    <div class="content width">
        <div class="top-header">
  <a class="site-title" href="https://shuxiao.wang">
    流水沉微
  </a>

  
  
  <div class="nav-body">
    
    
    <a class="nav-item " href="/posts/">
      
      <span>Posts</span>
    </a>
    
    
    
    <a class="nav-item " href="/cloud/">
      
      <span>Cloud</span>
    </a>
    
    
    
    <a class="nav-item " href="/eureka/">
      
      <span>Eureka!</span>
    </a>
    
    
  </div>
  
</div>

        <div>
            


<div class="Subhead">
    <div class="Subhead-heading">
        <h1>Auto mouse keyboard</h1>
    </div>
</div>




<article>
    
    <div class="true-content">
        <p>给兔子写了一个半自动化工具，让她可以自己编写流程的情况下，操作鼠标和键盘完成一系列任务。项目代码在 <a href="https://github.com/keaising/auto-mouse-keyboard/">https://github.com/keaising/auto-mouse-keyboard/</a></p>
<h2 id="使用">使用</h2>
<ol>
<li>在 Release 页面下载得到 exe 文件，将下载文件随意放到一个目录下</li>
<li>在同目录添加一个文本文件，名字是 amk.conf</li>
<li>在资源管理器地址栏输入 powershell</li>
<li>在弹出的新窗口中输入 .\auto-mouse-keyboard.exe 即可开始运行</li>
</ol>
<h2 id="配置文件-amkconf-格式说明">配置文件 amk.conf 格式说明</h2>
<p>配置文件中每行是一条指令，指令分为 3 类：注释、设置和流程</p>
<h3 id="注释指令">注释指令</h3>
<p>开头第一个字符是 <code>#</code> 的都是注释，比如</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># This is a comment</span>
</span></span></code></pre></div><p>如果一行什么都不写，或者全都写空格，那就是空指令，什么都不会影响也不会有任何作用</p>
<h3 id="设置指令">设置指令</h3>
<p>目前只有两个设置，设置每条命令执行的时间间隔(SHIM，单位毫秒)和设置当前显示器的分辨率缩放(SCALE)</p>
<p>下面设置中，第一行设置两条命令之间间隔 500 毫秒执行，第二行标示当前显示器的分辨率缩放了 150%</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">SHIM</span><span class="o">=</span><span class="m">500</span>
</span></span><span class="line"><span class="cl"><span class="nv">SCALE</span><span class="o">=</span>1.5
</span></span></code></pre></div><p>分辨率缩放主要是影响鼠标移动位置，在高分屏中会需要用到，当你发现鼠标移动的实际位置跟设定的位置不一致的时候需要检查，不设置的话默认是 1，没有缩放</p>
<h3 id="流程指令">流程指令</h3>
<p>流程分为 5 类</p>
<ul>
<li>鼠标移动</li>
<li>鼠标点击</li>
<li>键盘输入</li>
<li>键盘按键</li>
<li>暂停</li>
</ul>
<p><strong>鼠标移动</strong></p>
<p>以一个分辨率为 1920*1080 的屏幕为例，左上角坐标为(0,0)，右下角坐标为(1920,1080)</p>
<p>将鼠标移动到屏幕坐标 (300,200) 的位置</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">M</span><span class="o">=</span>300,200
</span></span></code></pre></div><p><strong>鼠标点击</strong></p>
<p>在当前位置点击鼠标</p>
<p>第一行：左键单击，第二行：左键双击，第三行：右键单击，第四行：右键双击</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">C</span><span class="o">=</span>left
</span></span><span class="line"><span class="cl"><span class="nv">C</span><span class="o">=</span>left,double
</span></span><span class="line"><span class="cl"><span class="nv">C</span><span class="o">=</span>right
</span></span><span class="line"><span class="cl"><span class="nv">C</span><span class="o">=</span>right,double
</span></span></code></pre></div><p><strong>键盘输入</strong></p>
<p>在当前位置输入文本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">I</span><span class="o">=</span><span class="m">23333</span>
</span></span><span class="line"><span class="cl"><span class="nv">I</span><span class="o">=</span>可以是中文，也可以是 I love Grace
</span></span><span class="line"><span class="cl"><span class="nv">I</span><span class="o">=</span>%^*<span class="o">(</span><span class="p">&amp;</span><span class="o">())(</span>
</span></span><span class="line"><span class="cl"><span class="nv">I</span><span class="o">=</span>可以包含各种特殊符号，也可以   有空格
</span></span></code></pre></div><p><strong>键盘按键</strong></p>
<p>可以是单个按键，也可以是组合键</p>
<p>单个按键包括 <code>a-z</code>、 <code>0-9</code>和以及普通的功能键</p>
<p>同时也可以使用组合键，比如耳熟能详的 <code>Ctrl+C</code>/ <code>Ctrl+V</code></p>
<p>所有支持的按键列表见 <a href="https://github.com/go-vgo/robotgo/blob/master/docs/keys.md">https://github.com/go-vgo/robotgo/blob/master/docs/keys.md</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>cmd
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>esc
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>c,ctrl
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>v,ctrl
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>d,cmd
</span></span><span class="line"><span class="cl"><span class="nv">T</span><span class="o">=</span>e,cmd
</span></span></code></pre></div><p>需要注意，使用组合键的时候，数字和字母需要放前面，功能键（比如 cmd/ctrl/shift）需要放后面，用逗号分隔开</p>
<p>下面只是列举常用的功能键</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">	<span class="s2">&#34;cmd&#34;</span>		is the <span class="s2">&#34;win&#34;</span> key <span class="k">for</span> windows
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;alt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;ctrl&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;shift&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;capslock&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;space&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;backspace&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;delete&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;enter&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;tab&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;esc&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;escape&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;up&#34;</span>		Up arrow key
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;down&#34;</span>		Down arrow key
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;right&#34;</span>		Right arrow key
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;left&#34;</span>		Left arrow key
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;home&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;end&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;pageup&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;pagedown&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f2&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f4&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f5&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f6&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f7&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f8&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f9&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f10&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f11&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s2">&#34;f12&#34;</span>
</span></span></code></pre></div><p><strong>暂停</strong></p>
<p>手动控制两个操作之间的间隔，真正的间隔会变成 (SHIM+S)毫秒，暂停的单位是毫秒</p>
<p>比如配置里 <code>SHIM=400</code>，脚本如下</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">T=enter
S=300
I=wow
</code></pre><p>那么，摁下回车和输入 <code>wow</code>之间的真实间隔是 <code>SHIM+S+SHIM=400+300+400=1100 ms</code></p>
<p>需要注意，使用组合键的时候，数字和字母需要放前面，功能键（比如 cmd/ctrl/shift）需要放后面，用逗号分隔开</p>
<p><strong>循环</strong></p>
<p>使一个片段反复执行 N 次，比如下列的语句</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">S=2000
C=left
I= begin

L=3
C=left
I=wow
T=enter*3
L

I= done
</code></pre><p>首先暂停 2000ms，左键点击一次，输入 <code>begin</code>，然后开始循环</p>
<p>在每次循环里，首先左键点击一次，输入 <code>wow</code>，然后摁 3 次回车</p>
<p>3 次循环结束后，输入 <code>done</code></p>
<p>两个 L 必须成对出现，否则最后一个单个 L 到结尾的内容会全部循环</p>
<p>成对出现的 L 以第一个 L 的次数为执行次数，不写就是 0 次</p>

    </div>

    <div class="page-info">
        <div>
            

<div>
    
</div>



<div>
    <a href='/tags/to-grace' class="tags-url">
        <span class="tags">to grace</span>
    </a>
</div>



        </div>
        
            
                <div class="publish-date">
                    <span
                        title="Lastmod: 2020-12-13. Published at: 2020-12-13.">
                        13 Dec 2020
                    </span>
                </div>
            
        
    </div>
</article>





        </div>
        <div id="footer" class="pt-2 pb-3 bg-white text-center">
            

  <span class="text-small text-gray">
    

    Powered by the
    <a href="https://github.com/keaising/kitto" class="link-gray-dark">Kitto</a> theme for
    <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>.
  </span>


        </div>
    </div>

    
    <script>
        anchors.add();
    </script>
    <script>
        anchors.options = {
            placement: 'left',
        };
        anchors.add();
        anchors.add(".tag-title-left");
    </script>
    <script src="/js/mathjax.js"></script>
</body>

</html>